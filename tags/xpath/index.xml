<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Xpath on Sudeep&#39;s Blog</title>
    <link>/tags/xpath/index.xml</link>
    <description>Recent content in Xpath on Sudeep&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="/tags/xpath/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Sitecore&#39;s site definition name cannot start with a number</title>
      <link>/2017/08/sitecore-site-definition-name-cannot-start-number/</link>
      <pubDate>Tue, 15 Aug 2017 18:55:00 +1000</pubDate>
      
      <guid>/2017/08/sitecore-site-definition-name-cannot-start-number/</guid>
      <description>&lt;p&gt;I felt the need for this post because first of all, this is most likely a rare scenario where you will need to name a site definition starting with a number. And when you do, the error you get will baffle you as it is in no way directly related to the change you&amp;rsquo;ve made. Let me explain!&lt;/p&gt;

&lt;p&gt;This is a typical site definition entry:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;site name=&amp;quot;website&amp;quot; enableTracking=&amp;quot;true&amp;quot; virtualFolder=&amp;quot;/&amp;quot; physicalFolder=&amp;quot;/&amp;quot; 
rootPath=&amp;quot;/sitecore/content&amp;quot; startItem=&amp;quot;/home&amp;quot; database=&amp;quot;web&amp;quot; domain=&amp;quot;extranet&amp;quot; 
allowDebug=&amp;quot;true&amp;quot; cacheHtml=&amp;quot;true&amp;quot; htmlCacheSize=&amp;quot;50MB&amp;quot; registryCacheSize=&amp;quot;0&amp;quot; 
viewStateCacheSize=&amp;quot;0&amp;quot; xslCacheSize=&amp;quot;25MB&amp;quot; filteredItemsCacheSize=&amp;quot;10MB&amp;quot; 
enablePreview=&amp;quot;true&amp;quot; enableWebEdit=&amp;quot;true&amp;quot; enableDebugger=&amp;quot;true&amp;quot; 
disableClientData=&amp;quot;false&amp;quot; cacheRenderingParameters=&amp;quot;true&amp;quot; 
renderingParametersCacheSize=&amp;quot;10MB&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is a site definition that has name starting with a number:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;site name=&amp;quot;3littlekittens&amp;quot; enableTracking=&amp;quot;true&amp;quot; ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When you run the site, you will see an error like below:&lt;/p&gt;



 
  
  
  
  
    
  
    
      
    
  

&lt;div class=&#34;figure center&#34; &gt;
  
    &lt;a class=&#34;fancybox&#34; href=&#34;/images/sitecore-site-definition-name-1-error.png&#34; title=&#34;System.Xml.XPath.XPathException: Expression must evaluate to a node-set&#34; data-fancybox-group=&#34;group:site-definition&#34;&gt;
  
    &lt;img class=&#34;fig-img&#34; src=&#34;/images/sitecore-site-definition-name-1-error.png&#34;  alt=&#34;System.Xml.XPath.XPathException: Expression must evaluate to a node-set&#34;&gt;
  
    &lt;/a&gt;
  
   
    &lt;span class=&#34;caption&#34;&gt;System.Xml.XPath.XPathException: Expression must evaluate to a node-set&lt;/span&gt;
  
&lt;/div&gt;


&lt;h3 id=&#34;the-error&#34;&gt;The Error&lt;/h3&gt;

&lt;pre&gt;&lt;code class=&#34;language-error&#34;&gt;System.Xml.XPath.XPathException: Expression must evaluate to a node-set.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have made a bunch of other changes in addition to the site definition, then at first glance you won&amp;rsquo;t be able to relate this error to the site definition change. Even with a deeper look it&amp;rsquo;s not easy to figure out why exactly a simple name change would result in this XPath exception. The clue, as always (or in most cases), is in the stack trace.&lt;/p&gt;



 
  
  
  
  
    
  
    
      
    
  

&lt;div class=&#34;figure center&#34; &gt;
  
    &lt;a class=&#34;fancybox&#34; href=&#34;/images/sitecore-site-definition-name-2-error-line.png&#34; title=&#34;Expression must evaluate to a node-set&#34; data-fancybox-group=&#34;group:site-definition&#34;&gt;
  
    &lt;img class=&#34;fig-img&#34; src=&#34;/images/sitecore-site-definition-name-2-error-line.png&#34;  alt=&#34;Expression must evaluate to a node-set&#34;&gt;
  
    &lt;/a&gt;
  
   
    &lt;span class=&#34;caption&#34;&gt;Expression must evaluate to a node-set&lt;/span&gt;
  
&lt;/div&gt;


&lt;p&gt;You will need to decompile the above line to find out exactly why:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-cs&#34;&gt;private long GetCacheSize(string attribute, Sitecore.Collections.StringDictionary properties, long defaultSize)
{
    ...
    string str = Factory.CreateObject(&amp;quot;cacheSizes/sites/&amp;quot; + this.name + &amp;quot;/&amp;quot; + attribute.Substring(0, attribute.Length - &amp;quot;CacheSize&amp;quot;.Length), false) as string;
    if (!string.IsNullOrEmpty(str))
        return StringUtil.ParseSizeString(str);
      return defaultSize;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Turns out that it&amp;rsquo;s not the &lt;code&gt;&amp;lt;site&amp;gt;&lt;/code&gt; definition that is the real problem, but the corresponding entry in the &lt;code&gt;&amp;lt;cacheSizes&amp;gt;&lt;/code&gt; definition that causes the error.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;cacheSizes&amp;gt;
    &amp;lt;sites&amp;gt;
      &amp;lt;website&amp;gt;
        &amp;lt;html&amp;gt;50MB&amp;lt;/html&amp;gt;
        &amp;lt;registry&amp;gt;0&amp;lt;/registry&amp;gt;
        &amp;lt;viewState&amp;gt;0&amp;lt;/viewState&amp;gt;
        &amp;lt;xsl&amp;gt;25MB&amp;lt;/xsl&amp;gt;
      &amp;lt;/website&amp;gt;
      &amp;lt;3littlekittens&amp;gt;  &amp;lt;!-- this is invalid xml --&amp;gt;
        ...
      &amp;lt;/3littlekittens&amp;gt;
    &amp;lt;/sites&amp;gt;
  &amp;lt;/cacheSizes&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The above code is trying to create an object out of the &lt;code&gt;cacheSizes/sites/3littlekittens&lt;/code&gt; node (even if it&amp;rsquo;s not present), which would be an invalid xml as one of the rule states that it cannot start with a number. So now we know what is exactly behind this error.&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Change the site name to not start with a number. :)&lt;/p&gt;

&lt;p&gt;This is by far the simplest solution that you can apply in most scenarios as it&amp;rsquo;s just the site name. I haven&amp;rsquo;t had a need to look for a better solution yet. Hope this will work for you too.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>